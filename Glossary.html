<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glossary</title>
    <!-- Add Supabase JS library FIRST -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ... keep your existing styles ... */
    </style>
</head>
<body>
    <!-- ... keep your existing HTML ... -->

    <script>
        // Create the Supabase client BEFORE any other code
        const { createClient } = supabase;
        const supabaseClient = createClient(
            'https://itpqpqtvtpdyraookiqf.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml0cHFwcXR2dHBkeXJhb29raXFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4NTc5MjYsImV4cCI6MjA0NTQzMzkyNn0.WVVtHy1spmEjl3_A2i8jEETyzgxmyAFM7yGhJ3oSp5w'
        );

        const glossaryForm = document.getElementById('glossaryForm');
        const glossaryList = document.getElementById('glossaryList');
        const searchInput = document.getElementById('searchInput');
        let glossary = [];

        async function loadGlossary() {
            try {
                const { data, error } = await supabaseClient
                    .from('glossary_entries')
                    .select('*')
                    .order('term');
                
                if (error) throw error;
                glossary = data || [];
                updateGlossaryDisplay();
            } catch (error) {
                console.error('Error loading glossary:', error);
            }
        }

        glossaryForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            const term = document.getElementById('term').value;
            const definition = document.getElementById('definition').value;
            
            try {
                const { error } = await supabaseClient
                    .from('glossary_entries')
                    .insert([{ 
                        term: term.trim(), 
                        definition: definition.trim() 
                    }]);

                if (error) throw error;
                glossaryForm.reset();
                await loadGlossary();
            } catch (error) {
                console.error('Error adding term:', error);
            }
        });

        // ... keep rest of your existing code but replace 'supabase' with 'supabaseClient' ...

        async function deleteEntry(id) {
            if (confirm("Are you sure you want to delete this entry?")) {
                try {
                    const { error } = await supabaseClient
                        .from('glossary_entries')
                        .delete()
                        .eq('id', id);
                    
                    if (error) throw error;
                    await loadGlossary();
                } catch (error) {
                    console.error('Error deleting term:', error);
                }
            }
        }

        // Initial load
        loadGlossary();
    </script>
</body>
</html>
